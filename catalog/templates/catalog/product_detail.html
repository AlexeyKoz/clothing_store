{% extends 'base.html' %}

{% block title %}{{ product.name }}{% endblock %}

{% block content %}
<h1>{{ product.name }}</h1>

<p><strong>Price:</strong> ${{ product.price }}</p>
<p><strong>Description:</strong> {{ product.description }}</p>
<p><strong>Brand:</strong> {{ product.brand.name }}</p>

{% if product.image %}
  <img src="{{ product.image.url }}" alt="{{ product.name }}" width="200">
{% else %}
  <p><em>No image available</em></p>
{% endif %}

<!-- ğŸ›’ Add to cart button -->
<form method="post" action="{% url 'cart:add_to_cart' product.id %}" style="display: inline;">
  {% csrf_token %}
  <button type="submit">ğŸ›’ Add to cart</button>
</form>

<!-- â¤ï¸ Like button -->
<form method="post" action="{% url 'catalog:like_product' product.id %}" style="display: inline;">
  {% csrf_token %}
  {% if liked %}
    <button type="submit">ğŸ’” Unlike</button>
  {% else %}
    <button type="submit">â¤ï¸ Like</button>
  {% endif %}
  <span>ğŸ‘ {{ like_count }}</span>
</form>

<hr>

<h3>ğŸ“ Reviews</h3>

<!-- ĞšĞ½Ğ¾Ğ¿ĞºĞ° Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¾Ñ‚Ğ·Ñ‹Ğ²Ğ° Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ -->
{% if user.is_authenticated %}
  {% if not user_has_review %}
    <p>
      <a href="{% url 'reviews:add_review' product.id %}">
        <button style="background-color: #28a745; color: white; padding: 8px 15px; border: none; cursor: pointer;">
          âœï¸ Write a Review
        </button>
      </a>
    </p>
  {% endif %}
{% else %}
  <p><em>Please <a href="{% url 'account_login' %}">login</a> to write a review.</em></p>
{% endif %}

{% if reviews %}
  <ul style="list-style: none; padding: 0;">
    {% for review in reviews %}
      <li style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; background-color: #f9f9f9;">
        <strong>{{ review.user.username }}</strong>

        <!-- ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ/ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ° Ğ¾Ñ‚Ğ·Ñ‹Ğ²Ğ° -->
        {% if user.is_authenticated and review.user == user %}
          <span style="float: right;">
            <a href="{% url 'reviews:edit_review' review.id %}" style="color: #007bff; text-decoration: none;">
              âœï¸ Edit
            </a>
            |
            <a href="{% url 'reviews:delete_review' review.id %}" style="color: #dc3545; text-decoration: none;">
              ğŸ—‘ï¸ Delete
            </a>
          </span>
        {% endif %}

        <br>
        {{ review.comment }}
        <br>
        <small><em>{{ review.created_at|date:"F j, Y, H:i" }}</em></small>
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>No reviews yet. Be the first to review this product!</p>
{% endif %}

{% endblock %}